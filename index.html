<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8" />
<!--允许全屏-->
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="yes" name="apple-touch-fullscreen" />
<meta content="telephone=no,email=no" name="format-detection" />
<meta name="flexible" data-dpr="1" />
<link href="http://gtms02.alicdn.com/tps/i2/TB1nmqyFFXXXXcQbFXXE5jB3XXX-114-114.png" rel="apple-touch-icon-precomposed">
<link href="http://gtms02.alicdn.com/tps/i2/TB1nmqyFFXXXXcQbFXXE5jB3XXX-114-114.png" rel="Shortcut Icon" type="image/x-icon" />
<link rel="stylesheet" href="http://g.tbcdn.cn/mtb/lib-bootstrap/3.0.3/css/bootstrap.min.css" />
<script src="http://g.tbcdn.cn/mtb/lib-3rd/??jquery/jquery.min.js"></script>
<script src="http://g.tbcdn.cn/mtb/lib-bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script src="http://g.tbcdn.cn/mtb/lib-flexible/0.2.1/??flexible_css.js,flexible.js"></script>
<link href="http://g.tbcdn.cn/mtb/ctrl-loading/0.1.6/loading.css" rel="stylesheet" type="text/css" />
<link href="build/scrollview.debug.css" rel="stylesheet" type="text/css" />
<title>Demo - ctrl.scrollview - 无线资源平台 - http://ml.x.taobao.net</title>
<style>
    html, body {
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    .row {
        padding: 0.5rem;
    }

    ul {
        border: 1px solid #999;
        border-radius: 4px;
    }

    ul li {
        border-bottom: 1px solid #999;
        height: 2rem;
        line-height: 2rem;
        font-size: 0.5rem;
        padding: 0 0.5rem;
    }

    ul li:nth-child(2n) {
        background-color: #DDD;
    }

    ul li:last-child {
        border-bottom: 0;
    }
</style>
</head>
<body>
<section class="jumbotron">
    <div class="container">
        <h1 class="center">lib.scrollview</h1>
    </div>
</section>

<script src="build/combo.debug.js" type="text/javascript"></script>
<script src="build/scrollview.debug.js" type="text/javascript"></script>
<script id="content" type="text/template">
    <div class="container">
        <div class="row">
            <ul></ul>
        </div>
    </div>
</script>
<script>
    (function() {
        var headerEl = document.querySelector('.jumbotron');
        var contentHTML = document.querySelector('#content').innerHTML;

        var scrollView = new ctrl.scrollview({
            padding: {
                top: headerEl.getBoundingClientRect().height
            }
        });

        scrollView.content = contentHTML;
        scrollView.plugin.fixed = headerEl;
        scrollView.plugin.refresh = true;
        scrollView.plugin.update = true;

        scrollView.addEventListener('plugin:refresh', function(e){
            scrollView.element.querySelector('.row ul').innerHTML = '';
            floor = 1;
            render();
            e.done();
        }, false);

        scrollView.addEventListener('plugin:update', function(e){
            setTimeout(function() {
                render();
                e.done();
            }, 1000);
        }, false);

        var floor = 1;
        function render() {
            var fragment = document.createDocumentFragment();
            for (var i = 0; i < 20; i++) {
                var li = document.createElement('li');
                li.innerHTML = 'FLOOR ' + floor;
                li.style.cssText = '-webkit-transform: translateZ(' + parseInt(floor/20) + 'px);';
                fragment.appendChild(li);
                floor++;
            }
            scrollView.element.querySelector('.row ul').appendChild(fragment);
        }

        render();
        document.body.appendChild(scrollView.root);
        scrollView.refresh();

    })();
</script>
</body>

</html>

